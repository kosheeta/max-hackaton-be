src:
  bot:
    token: !env "BOT_TOKEN:"
  redis:
    url: !env "REDIS_URL:"
rewire:
  log:
    sinks:
      - level: !env LOG_LEVEL:TRACE
rewire_fastapi:
  server: "uvicorn"
  app:
    title: "max"
  uvicorn:
    port: 8080
    host: "0.0.0.0"
  patch:
    swagger_hierarchical_tags: true
    tag_prefixes: true
  middleware:
    cors:
      allow_origins: [ "*" ]
      allow_methods: [ "*" ]
      allow_headers: [ "*" ]
rewire_sqlmodel:
  url: !pyexec |
    from os import getenv
    return getenv("DATABASE_URL").replace("postgresql://", "postgresql+asyncpg://")
  expire_on_commit: false
  alembic:
    generate: true
    schema_migrations: true
    env:
      render_as_batch: true
